# spDist_mFiles
The MIT License (MIT)
Copyright (c) 2021 Grace E. Hallenbeck, Thomas C. Sprague, Masih Rahmati, Kartik Sreenivasan, & Clayton E. Curtis

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

dependencies
within spDist_mFiles:
RMAOV1_gh.m
RMAOV2_gh.m
RMAOV33_gh.m
RMAOV1.m
RMAOV2.m
RMAOV33.m
spDist_condColors.m
spDist_randSeed.m
spDist_concatBehav.m
spDist_loadRoot (should be modified to point to where neural data is stored)
to recreate the Figures shown in Hallenbeck et al, 2021, run the following code
dependencies included in spDist_mFiles

software:
Matlab2018b (or higher, though untested outside Matlab2018b)

hardware: n/a
install time: download

Instructions & Expected output
The plots used to create figures are noted in the figure titles.
Expected run-time: contingent on user choices, 45 min minimum.
to recreate any corresponding Supplementary Figures, change ROI argument to
ROIs = {'V1','V2','V3','V3AB','hV4','LO1','IPS0','IPS1','IPS2','IPS3','sPCS'};
1. spDist_behavioralAnalysis (Figure 1)
Sections denote portions of Figure 1. Ensure behavioral data is accessible by 'root'. Eye data shared herein has been extracted, preprocessed, and scored by iEye_ts (github/tommysprague/iEye_ts). To plot aligned eye traces (1B) and scatter plot (1C; takes > 10 mins), set scatterplot_1BC = 1. Supplementary Figure 1 data is automatically produced.
2. spDist_plotHRFs_ERA_pRFvoxSelection_btwnRFstats (Figure 2)
Change spDist_loadRoot to location where extracted neural data has been stored locally. 4th input argument, 'alignment' defaults to target position. To recreate Figure 2c (distractor aligned Rf in vs out), set alignment argument to 'dist_ang_all'.
3. spDist_plotBasis,  spDist_exampleTrial.m (Figure 3)
3A is a screenshot from a retinotopy sesssion in SUMA. plotBasis recreates 3B (left), _exampleTrial creates  3B (right).
4. spDist_plotReconstructions_condAlign (Figure 4). Plots 3 separate plots for Figure 4 A (distractor absent, target aligned) B (distractor present, target aligned), & C (distractor present, distractor aligned)(Figure 4). To obtain statistical results examining fidelity on a TR basis, compared to a null-distribution, run spDist_fidelity_stats_shuf.m. Requires _reconthruTime1_shuff1000.mat (in spDist_reconstructions dir) (Figure 4DE). takes ~15 minutes
5. spDist_epochFidelity_statsShuf.m (Figure 5). stats take ~20 minutes
6. spDist_plotGAT1, spDist_modelCompare, & spDist_modelCompare_offDiag(Figure 6)
spDist_plotGAT1 uses GAT/LORO model with name _GATdist_gh(Figure 6B)
relies on GAT trained data generated by spDist_channelRespAmp_GATdist, saved with _GATdist_gh (IMPORTANT spDist_channelRespAmp_GATdist.m can take up to 24 hours to run.)
spDist_modelCompare loads relatively quickly, creates (Fig 6C & D)
spDist_modelCompare_offDiag will take ~2 hours to load on a regular CPU. on GPU, takes ~20 minutes. Creates Figure 6E.
7. spDist_neuralBehavCorr_revised (Figure 7)
sections of Figure 7 are marked in Figure title.
